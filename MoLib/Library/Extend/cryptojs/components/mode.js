exports.mode.CFB=(function(){var b=exports.lib.BlockCipherMode.extend();b.Encryptor=b.extend({processBlock:function(f,e){var c=this._cipher;var d=c.blockSize;a.call(this,f,e,d,c);this._prevBlock=f.slice(e,e+d)}});b.Decryptor=b.extend({processBlock:function(g,f){var c=this._cipher;var e=c.blockSize;var d=g.slice(f,f+e);a.call(this,g,f,e,c);this._prevBlock=d}});function a(j,h,f,c){var d=this._iv;if(d){var g=d.slice(0);this._iv=undefined}else{var g=this._prevBlock}c.encryptBlock(g,0);for(var e=0;e<f;e++){j[h+e]^=g[e]}}return b}());exports.mode.CTR=(function(){var b=exports.lib.BlockCipherMode.extend();var a=b.Encryptor=b.extend({processBlock:function(k,j){var c=this._cipher;var g=c.blockSize;var e=this._iv;var d=this._counter;if(e){d=this._counter=e.slice(0);this._iv=undefined}var h=d.slice(0);c.encryptBlock(h,0);d[g-1]=(d[g-1]+1)|0;for(var f=0;f<g;f++){k[j+f]^=h[f]}}});b.Decryptor=a;return b}());exports.mode.CTRGladman=(function(){var a=exports.lib.BlockCipherMode.extend();function d(h){if(((h>>24)&255)===255){var g=(h>>16)&255;var f=(h>>8)&255;var e=h&255;if(g===255){g=0;if(f===255){f=0;if(e===255){e=0}else{++e}}else{++f}}else{++g}h=0;h+=(g<<16);h+=(f<<8);h+=e}else{h+=(1<<24)}return h}function c(e){if((e[0]=d(e[0]))===0){e[1]=d(e[1])}return e}var b=a.Encryptor=a.extend({processBlock:function(m,l){var e=this._cipher;var j=e.blockSize;var g=this._iv;var f=this._counter;if(g){f=this._counter=g.slice(0);this._iv=undefined}c(f);var k=f.slice(0);e.encryptBlock(k,0);for(var h=0;h<j;h++){m[l+h]^=k[h]}}});a.Decryptor=b;return a}());exports.mode.ECB=(function(){var a=exports.lib.BlockCipherMode.extend();a.Encryptor=a.extend({processBlock:function(c,b){this._cipher.encryptBlock(c,b)}});a.Decryptor=a.extend({processBlock:function(c,b){this._cipher.decryptBlock(c,b)}});return a}());exports.mode.OFB=(function(){var b=exports.lib.BlockCipherMode.extend();var a=b.Encryptor=b.extend({processBlock:function(j,h){var c=this._cipher;var f=c.blockSize;var d=this._iv;var g=this._keystream;if(d){g=this._keystream=d.slice(0);this._iv=undefined}c.encryptBlock(g,0);for(var e=0;e<f;e++){j[h+e]^=g[e]}}});b.Decryptor=a;return b}());