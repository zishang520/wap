exports.lib.Cipher||(function(W){var N=exports;var D=N.lib;var R=D.Base;var G=D.WordArray;var E=D.BufferedBlockAlgorithm;var I=N.enc;var U=I.Utf8;var O=I.Base64;var Y=N.algo;var S=Y.EvpKDF;var Q=D.Cipher=E.extend({cfg:R.extend(),createEncryptor:function(b,a){return this.create(this._ENC_XFORM_MODE,b,a)},createDecryptor:function(b,a){return this.create(this._DEC_XFORM_MODE,b,a)},init:function(b,c,a){this.cfg=this.cfg.extend(a);this._xformMode=b;this._key=c;this.reset()},reset:function(){E.reset.call(this);this._doReset()},process:function(a){this._append(a);return this._process()},finalize:function(b){if(b){this._append(b)}var a=this._doFinalize();return a},keySize:128/32,ivSize:128/32,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:(function(){function a(b){if(typeof b=="string"){return T}else{return A}}return function(b){return{encrypt:function(c,d,e){return a(d).encrypt(b,c,d,e)},decrypt:function(c,d,e){return a(d).decrypt(b,c,d,e)}}}}())});var K=D.StreamCipher=Q.extend({_doFinalize:function(){var a=this._process(!!"flush");return a},blockSize:1});var H=N.mode={};var B=D.BlockCipherMode=R.extend({createEncryptor:function(a,b){return this.Encryptor.create(a,b)},createDecryptor:function(a,b){return this.Decryptor.create(a,b)},init:function(a,b){this._cipher=a;this._iv=b}});var X=H.CBC=(function(){var a=B.extend();a.Encryptor=a.extend({processBlock:function(c,d){var f=this._cipher;var e=f.blockSize;b.call(this,c,d,e);f.encryptBlock(c,d);this._prevBlock=c.slice(d,d+e)}});a.Decryptor=a.extend({processBlock:function(c,d){var g=this._cipher;var e=g.blockSize;var f=c.slice(d,d+e);g.decryptBlock(c,d);b.call(this,c,d,e);this._prevBlock=f}});function b(c,d,f){var h=this._iv;if(h){var e=h;this._iv=W}else{var e=this._prevBlock}for(var g=0;g<f;g++){c[d+g]^=e[g]}}return a}());var V=N.pad={};var Z=V.Pkcs7={pad:function(d,f){var e=f*4;var b=e-d.sigBytes%e;var a=(b<<24)|(b<<16)|(b<<8)|b;var g=[];for(var h=0;h<b;h+=4){g.push(a)}var c=G.create(g,b);d.concat(c)},unpad:function(a){var b=a.words[(a.sigBytes-1)>>>2]&255;a.sigBytes-=b}};var J=D.BlockCipher=Q.extend({cfg:Q.cfg.extend({mode:X,padding:Z}),reset:function(){Q.reset.call(this);var a=this.cfg;var d=a.iv;var b=a.mode;if(this._xformMode==this._ENC_XFORM_MODE){var c=b.createEncryptor}else{var c=b.createDecryptor;this._minBufferSize=1}this._mode=c.call(b,this,d&&d.words)},_doProcessBlock:function(b,a){this._mode.processBlock(b,a)},_doFinalize:function(){var b=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){b.pad(this._data,this.blockSize);var a=this._process(!!"flush")}else{var a=this._process(!!"flush");b.unpad(a)}return a},blockSize:128/32});var L=D.CipherParams=R.extend({init:function(a){this.mixIn(a)},toString:function(a){return(a||this.formatter).stringify(this)}});var M=N.format={};var F=M.OpenSSL={stringify:function(a){var b=a.ciphertext;var d=a.salt;if(d){var c=G.create([1398893684,1701076831]).concat(d).concat(b)}else{var c=b}return c.toString(O)},parse:function(c){var d=O.parse(c);var b=d.words;if(b[0]==1398893684&&b[1]==1701076831){var a=G.create(b.slice(2,4));b.splice(0,4);d.sigBytes-=16}return L.create({ciphertext:d,salt:a})}};var A=D.SerializableCipher=R.extend({cfg:R.extend({format:F}),encrypt:function(a,c,e,g){g=this.cfg.extend(g);var f=a.createEncryptor(e,g);var b=f.finalize(c);var d=f.cfg;return L.create({ciphertext:b,key:e,iv:d.iv,algorithm:a,mode:d.mode,padding:d.padding,blockSize:a.blockSize,formatter:g.format})},decrypt:function(a,b,d,e){e=this.cfg.extend(e);b=this._parse(b,e.format);var c=a.createDecryptor(d,e).finalize(b.ciphertext);return c},_parse:function(a,b){if(typeof a=="string"){return b.parse(a,this)}else{return a}}});var P=N.kdf={};var C=P.OpenSSL={execute:function(e,b,a,c){if(!c){c=G.random(64/8)}var d=S.create({keySize:b+a}).compute(e,c);var f=G.create(d.words.slice(b),a*4);d.sigBytes=b*4;return L.create({key:d,iv:f,salt:c})}};var T=D.PasswordBasedCipher=A.extend({cfg:A.cfg.extend({kdf:C}),encrypt:function(a,d,e,f){f=this.cfg.extend(f);var b=f.kdf.execute(e,a.keySize,a.ivSize);f.iv=b.iv;var c=A.encrypt.call(this,a,d,b.key,f);c.mixIn(b);return c},decrypt:function(a,c,e,f){f=this.cfg.extend(f);c=this._parse(c,f.format);var b=f.kdf.execute(e,a.keySize,a.ivSize,c.salt);f.iv=b.iv;var d=A.decrypt.call(this,a,c,b.key,f);return d}})}());