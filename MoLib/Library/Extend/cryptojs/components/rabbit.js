(function(){var a=exports;var b=a.lib;var c=b.StreamCipher;var f=a.algo;var d=[];var e=[];var g=[];var h=f.Rabbit=c.extend({_doReset:function(){var t=this._key.words;var o=this.cfg.iv;for(var q=0;q<4;q++){t[q]=(((t[q]<<8)|(t[q]>>>24))&16711935)|(((t[q]<<24)|(t[q]>>>8))&4278255360)}var k=this._X=[t[0],(t[3]<<16)|(t[2]>>>16),t[1],(t[0]<<16)|(t[3]>>>16),t[2],(t[1]<<16)|(t[0]>>>16),t[3],(t[2]<<16)|(t[1]>>>16)];var j=this._C=[(t[2]<<16)|(t[2]>>>16),(t[0]&4294901760)|(t[1]&65535),(t[3]<<16)|(t[3]>>>16),(t[1]&4294901760)|(t[2]&65535),(t[0]<<16)|(t[0]>>>16),(t[2]&4294901760)|(t[3]&65535),(t[1]<<16)|(t[1]>>>16),(t[3]&4294901760)|(t[0]&65535)];this._b=0;for(var q=0;q<4;q++){i.call(this)}for(var q=0;q<8;q++){j[q]^=k[(q+4)&7]}if(o){var u=o.words;var s=u[0];var r=u[1];var p=(((s<<8)|(s>>>24))&16711935)|(((s<<24)|(s>>>8))&4278255360);var m=(((r<<8)|(r>>>24))&16711935)|(((r<<24)|(r>>>8))&4278255360);var n=(p>>>16)|(m&4294901760);var l=(m<<16)|(p&65535);j[0]^=p;j[1]^=n;j[2]^=m;j[3]^=l;j[4]^=p;j[5]^=n;j[6]^=m;j[7]^=l;for(var q=0;q<4;q++){i.call(this)}}},_doProcessBlock:function(m,k){var l=this._X;i.call(this);d[0]=l[0]^(l[5]>>>16)^(l[3]<<16);d[1]=l[2]^(l[7]>>>16)^(l[5]<<16);d[2]=l[4]^(l[1]>>>16)^(l[7]<<16);d[3]=l[6]^(l[3]>>>16)^(l[1]<<16);for(var j=0;j<4;j++){d[j]=(((d[j]<<8)|(d[j]>>>24))&16711935)|(((d[j]<<24)|(d[j]>>>8))&4278255360);m[k+j]^=d[j]}},blockSize:128/32,ivSize:64/32});function i(){var q=this._X;var p=this._C;for(var k=0;k<8;k++){e[k]=p[k]}p[0]=(p[0]+1295307597+this._b)|0;p[1]=(p[1]+3545052371+((p[0]>>>0)<(e[0]>>>0)?1:0))|0;p[2]=(p[2]+886263092+((p[1]>>>0)<(e[1]>>>0)?1:0))|0;p[3]=(p[3]+1295307597+((p[2]>>>0)<(e[2]>>>0)?1:0))|0;p[4]=(p[4]+3545052371+((p[3]>>>0)<(e[3]>>>0)?1:0))|0;p[5]=(p[5]+886263092+((p[4]>>>0)<(e[4]>>>0)?1:0))|0;p[6]=(p[6]+1295307597+((p[5]>>>0)<(e[5]>>>0)?1:0))|0;p[7]=(p[7]+3545052371+((p[6]>>>0)<(e[6]>>>0)?1:0))|0;this._b=(p[7]>>>0)<(e[7]>>>0)?1:0;for(var k=0;k<8;k++){var m=q[k]+p[k];var o=m&65535;var l=m>>>16;var j=((((o*o)>>>17)+o*l)>>>15)+l*l;var n=(((m&4294901760)*m)|0)+(((m&65535)*m)|0);g[k]=j^n}q[0]=(g[0]+((g[7]<<16)|(g[7]>>>16))+((g[6]<<16)|(g[6]>>>16)))|0;q[1]=(g[1]+((g[0]<<8)|(g[0]>>>24))+g[7])|0;q[2]=(g[2]+((g[1]<<16)|(g[1]>>>16))+((g[0]<<16)|(g[0]>>>16)))|0;q[3]=(g[3]+((g[2]<<8)|(g[2]>>>24))+g[1])|0;q[4]=(g[4]+((g[3]<<16)|(g[3]>>>16))+((g[2]<<16)|(g[2]>>>16)))|0;q[5]=(g[5]+((g[4]<<8)|(g[4]>>>24))+g[3])|0;q[6]=(g[6]+((g[5]<<16)|(g[5]>>>16))+((g[4]<<16)|(g[4]>>>16)))|0;q[7]=(g[7]+((g[6]<<8)|(g[6]>>>24))+g[5])|0}a.Rabbit=c._createHelper(h)}());